<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html class="theme-dark">
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Interactions </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Interactions ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/stackoverflow-dark.min.css" integrity="sha512-Xn1b0y/BrCD7usnEh6r9CcKxHXFVleVUjGDnfc95zDDwFUwtOz3lJC/XtJcuLRNyrMQJEEToFfwjC9Ue/aWY/g==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/stackoverflow-light.min.css" integrity="sha512-RDtnAhiPytLVV3AwzHkGVMVI4szjtSjxxyhDaH3gqdHPIw5qwQld1MVGuMu1EYoof+CaEccrO3zUVb13hQFU/A==" crossorigin="anonymous" disabled="disabled">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/solid.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../../styles/colors.css">
    <link rel="stylesheet" href="../../styles/discord.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>

  <body>

        <div class="body-content">

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    
                    
                    <div>
                      
                      <a class="brand" href="../../index.html">
                        <img src="../../logo.svg" alt="alt:V" class="logomark">
                        <span class="brand-title">alt:V</span>
                      </a>
                      <div id="navbar">
                    
                      </div>
                    
                    </div>



                </div>


            </nav>

            <main class="main-panel">

                <div class="blackout desktop-hide"></div>

                    
                    <div class="subnav navbar navbar-default">
                      <button class="btn-link search-back desktop-hide"></button>
                      <button class="btn-link navbar-toggler" aria-label="Toggle navigation"></button>
                      <div class="container" id="breadcrumb">
                        <ul class="breadcrumb">
                          <li></li>
                        </ul>
                      </div>
                      <div class="flex-space"></div>
                      <div class="toolbar">
                          <div style="position: relative; margin: 0 8px;">
                            <form class="search-bar mobile-hide" role="search" id="search" style="position: relative;">
                              <button class="btn-link clear" id="search-query-clear"></button>
                              <!-- <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off"> -->
                              <div role="textbox" class="form-control" id="search-query" placeholder="Search" contenteditable="true"></div>
                            </form>
                            <div class="popout" id="search-menu">
                              <span class="title">
                                Search options:
                              </span>
                            </div>
                            <button class="btn-link search-tip desktop-hide"></button>
                          </div>
                      </div>
                      <button class="btn-link btn-floating search desktop-hide"></button>
                      <div class="theme">
                        <button class="btn-link theme" aria-label="Switch theme"></button>
                        <div class="popout" id="theme-menu">
                          <div class="theme-option light" data-theme="light">
                            <span class="btn-link theme-light">Light</span>
                          </div>
                          <div class="theme-option dark" data-theme="dark">
                            <span class="btn-link theme-dark">Dark</span>
                          </div>
                          <div class="theme-option auto" data-theme="auto">
                            <span class="btn-link theme-auto">Sync with OS</span>
                          </div>
                        </div>
                      </div>
                    </div>

                <div class="content-region" role="main">

                    <div class="content-column Conceptual">

                            
                            <div class="sideaffix hide-when-search" data-noindex="">
                              <h3>Index</h3>
                              <div class="bs-docs-sidebar affix" id="affix">
                                <div></div>
                              </div>
                            </div>

                            
                            <div id="search-results">
                              <div class="search-list">Search Results for <span></span></div>
                              <div class="sr-items">
                                <p><span class="glyphicon glyphicon-refresh index-loading"></span></p>
                              </div>
                              <ul id="pagination" data-first="" data-prev="&#xf053;" data-next="&#xf054;" data-last=""></ul>
                            </div>

                        <article class="content wrap hide-when-search" id="_content" data-uid="">

                                <span class="small pull-right article mobile-hide" style="margin: 0;" data-noindex="">
                                    <ul class="subnav contribution">
                                            <li>
                                                <a href="https://github.com/FabianTerhorst/coreclr-module/blob/master/docs/articles/interactions.md/#L1">Improve this Doc</a>
                                            </li>
                                    </ul>
                                </span>

<h1 id="interactions">Interactions</h1>

<p>This article will describe how to add fast serverside player interactions.
You can also use the interactions for something else then player interactions, but player interactions are the common usecase for them.</p>
<h2 id="setup-interactions">Setup Interactions</h2>
<p>First download the nuget package to access the interaction api's:
<a href="https://www.nuget.org/packages/AltV.Net.interactions">https://www.nuget.org/packages/AltV.Net.interactions</a></p>
<p>Next you need to init the interactions package. The best place to do this is when your resource is starting.</p>
<p>Note: It doesn't matter if your resource is a async resource. The code below is just for illustrating how to do it in general.</p>
<pre><code class="lang-csharp">public class MyResource: Resource
{
    public override void OnStart()
    {
      // (some code from you)
      AltInteractions.Init();
      // (some code from you)
    }
    
    public override void OnStop()
    {
      // (some code from you)
      AltInteractions.Dispose();
      // (some code from you)
    }
}
</code></pre>
<p>Now the interaction package setup is done and ready to be used.</p>
<h2 id="create-interactions">Create interactions</h2>
<p>To create a interaction you need to create a instance of it first.</p>
<p>This is how the default constructor looks like.</p>
<pre><code class="lang-csharp">var interaction = new Interaction(ulong type, ulong id, Vector3 position, int dimension, uint range);
</code></pre>
<p>The first parameter is the type. This defines the interaction type. A type can be anything you want to use it for. A example might be:
type 1 = house, type 2 = car shop, ect.</p>
<p>The second parameter is the id. This defines the interaction id for the given type. Only the id + type in combination needs to be unique.
You can have the same id used in different types. This is useful when you already have ids for houses and car shops and both have own auto incrementing counters starting at 1.</p>
<p>The third parameter is the position. This defines the position this interaction is present.</p>
<p>The fourth parameter is the dimension. This defines the dimension this interaction is visible inside. The dimension logic is the same as for players, vehicle ect.</p>
<pre><code>X can see only X
-X can see 0 and -X
0 can't see -X and X
</code></pre>
<p>And the fifth and last parameter is the range. This defines the range this interaction is usable in.</p>
<h2 id="add-interactions">Add Interactions</h2>
<p>To add a interaction to the system you can just call:</p>
<pre><code class="lang-csharp">AltInteractions.AddInteraction(interaction);
</code></pre>
<h2 id="remove-interactions">Remove Interactions</h2>
<p>To remove a interaction from the system you can just call:</p>
<pre><code class="lang-csharp">AltInteractions.RemoveInteraction(interaction);
</code></pre>
<h2 id="find-interactions">Find Interactions</h2>
<p>To find all interactions that are on a specific position and visible for a specific dimensions you can call:</p>
<pre><code class="lang-csharp">var interactions = await AltInteractions.FindInteractions(position, dimension);
</code></pre>
<p>As you can see on the code this method returns a task that needs to be awaited.</p>
<p>Now we have a list of all interactions that are visible at this specific dimension and are in range of the positions.
The returned object is null when no interactions are found.</p>
<pre><code class="lang-csharp"> foreach (var interaction in interactions)
 {
   // do stuff with interaction.Id and interaction.Type
 }
</code></pre>
<h2 id="create-custom-interactions">Create custom interactions</h2>
<p>You might want to add custom interactions to add custom data to them.</p>
<p>One example would be to add your house object to the interaction.</p>
<p>You have to add the default constructor when inherit from <code>Interaction</code></p>
<pre><code class="lang-csharp">public class HouseInteraction: Interaction 
{
    public HouseEntity House { get; }

    public HouseInteraction( HouseEntity house, ulong type, ulong id, Vector3 position, int dimension, uint range) : base(type, id,
            position, dimension, range)
    {
         House = house;
    }
}
</code></pre>
<p>Lets see how our interactions loop from above now looks like:</p>
<pre><code class="lang-csharp"> foreach (var interaction in interactions)
 {
   if (interaction is HouseInteraction houseInteraction) {
       // do something with houseInteraction.House
   }
 }
</code></pre>
<p>We can now get the house object from the interaction instead of using the interaction id and type to fetch it.
Note: You still should use the correct id and type to add and remove the interactions correctly.</p>
<h2 id="trigger-interactions">Trigger interactions</h2>
<p>With custom classes you can make use of another feature that is available.</p>
<p>The Interaction class has a abstract method you can override.</p>
<pre><code class="lang-csharp">public class HouseInteraction: Interaction 
{
    public HouseEntity House { get; }

    public HouseInteraction( HouseEntity house, ulong type, ulong id, Vector3 position, int dimension, uint range) : base(type, id,
            position, dimension, range)
    {
        House = house;
    }
    
    public override bool OnInteraction(IPlayer player, Vector3 interactionPosition, int interactionDimension)
    {
        // do something with the House obj
        return false;
    }
}
</code></pre>
<p>This method is getting triggered each time you call:</p>
<pre><code class="lang-csharp">AltInteractions.TriggerInteractions(player);
</code></pre>
<p>When you returns false from a interaction you allow other interactions that might be in range as well to also call OnInteraction.
When you return true, no other interaction will trigger.</p>
<p>The OnInteraction method is triggered inside a async context. It should be none blocking to not block other interactions since they run in the same task. When you need to use await inside it start a new task with Task.Run. Make sure to use the altv.net apis inside the async context correctly.</p>
</article>
                    </div>

                </div>

            </main>

        </div>

        
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twbs-pagination/1.4.2/jquery.twbsPagination.min.js" integrity="sha512-frFP3ZxLshB4CErXkPVEXnd5ingvYYtYhE5qllGdZmcOlRKNEPbufyupfdSTNmoF5ICaQNO6SenXzOZvoGkiIA==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js" integrity="sha512-ubuT8Z88WxezgSqf3RLuNi5lmjstiJcyezx34yIU2gAHonIi27Na7atqzUZCOoY4CExaoFumzOsFQ2Ch+I/HCw==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js" integrity="sha512-zol3kFQ5tnYhL7PzGt0LnllHHVWRGt2bTCIywDiScVvLIlaDOVJ6sPdJTVi0m3rA660RT+yZxkkRzMbb1L8Zkw==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js" integrity="sha512-axd5V66bnXpNVQzm1c7u1M614TVRXXtouyWCE+eMYl8ALK8ePJEs96Xtx7VVrPBc0UraCn63U1+ARFI3ofW+aA==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-url/1.8.8/url.min.js" integrity="sha512-r7Z8tYN1iMr6CTQ7pNJa2q+3owm4Tc6dLkVzGV68AFGiI0muMh5eLVQlas5kb9qwPY168HsTBctUwn3k0FVqyw==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js" integrity="sha512-G2OGlm41XXw+fcgDcRPjVYEn7qCY6qiKWNqDGT37SnKh0qtRXTuKZ5/UQR0kDN0PZRNWcGExd3lAeqEH0I36bQ==" crossorigin="anonymous"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.js" crossorigin="anonymous"></script>
<script type="text/javascript" src="../../styles/docfx.js"></script>
<script type="text/javascript" src="../../styles/discord.js"></script>
<script type="text/javascript" src="../../styles/main.js"></script>

    </body>

</html>
